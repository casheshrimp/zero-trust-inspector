# Zero Trust Policy for OpenWrt
# Generated by ZeroTrust Inspector
# Policy: {{ policy_name }}

{% for zone in zones %}
# Zone: {{ zone.name }}
config zone '{{ zone.name|lower|replace(" ", "_") }}'
    option name '{{ zone.name }}'
    option description '{{ zone.description }}'
    list network 'lan'
    option input 'ACCEPT'
    option output 'ACCEPT'
    option forward 'REJECT'
    option masq '1'
    option mtu_fix '1'

{% endfor %}

{% for rule in rules %}
# Rule: {{ rule.description }}
config rule
    option name '{{ rule.source }}_to_{{ rule.dest }}'
    option src '{{ rule.source|lower|replace(" ", "_") }}'
    option dest '{{ rule.dest|lower|replace(" ", "_") }}'
    option proto '{{ rule.protocol }}'
    {% if rule.ports %}
    option dest_port '{{ rule.ports|join(",") }}'
    {% endif %}
    option target '{{ rule.action|upper }}'
    option enabled '1'

{% endfor %}